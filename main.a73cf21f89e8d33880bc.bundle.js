webpackJsonp([0,3],{225:function(t,n,e){"use strict";var r=e(1),i=e(316),a=e(378),s=(e.n(a),e(378));e.n(s);e.d(n,"a",function(){return c});var o=this&&this.__decorate||function(t,n,e,r){var i,a=arguments.length,s=a<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,e,r);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(s=(a<3?i(s):a>3?i(n,e,s):i(n,e))||s);return a>3&&s&&Object.defineProperty(n,e,s),s},l=this&&this.__metadata||function(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},c=function(){function t(t){this.jsonp=t,this.logItemsChanged=new r.EventEmitter,this.jsonError=new r.EventEmitter,this.logItems=[],this.apiUrl="https://parkingapi.gear.host/v1/parking?items=100"}return t.prototype.getLogs=function(){var t=this,n=new i.a;n.append("Content-Type","application/json");var e=this.apiUrl.indexOf("?"),r=e>0?"&":"?";this.jsonp.get(this.apiUrl+r+"callback=JSONP_CALLBACK").map(function(t){return t.json()}).catch(this.handleError).subscribe(function(n){t.logItems=n,t.logItemsChanged.emit(t.logItems)},function(n){t.jsonError.emit(n)})},t.prototype.handleError=function(t){var n;if(t instanceof i.b){var e=t.json()||"",r=e.error||JSON.stringify(e);n=t.status+" - "+(t.statusText||"")+" "+r}else n=t.message?t.message:t.toString();return s.Observable.throw(n)},t=o([e.i(r.Injectable)(),l("design:paramtypes",["function"==typeof(n="undefined"!=typeof i.c&&i.c)&&n||Object])],t);var n}()},408:function(t,n){function e(t){throw new Error("Cannot find module '"+t+"'.")}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id=408},409:function(t,n,e){"use strict";var r=e(520),i=(e.n(r),e(495)),a=e(1),s=e(519),o=e(516);s.a.production&&e.i(a.enableProdMode)(),e.i(i.a)().bootstrapModule(o.a)},515:function(t,n,e){"use strict";var r=e(1),i=e(225);e.d(n,"a",function(){return o});var a=this&&this.__decorate||function(t,n,e,r){var i,a=arguments.length,s=a<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,e,r);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(s=(a<3?i(s):a>3?i(n,e,s):i(n,e))||s);return a>3&&s&&Object.defineProperty(n,e,s),s},s=this&&this.__metadata||function(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},o=function(){function t(t){this.httpService=t}return t.prototype.ngOnInit=function(){this.httpService.getLogs()},t.prototype.onResize=function(t){},t=a([e.i(r.Component)({selector:"app-root",template:e(689),styles:[e(687)]}),s("design:paramtypes",["function"==typeof(n="undefined"!=typeof i.a&&i.a)&&n||Object])],t);var n}()},516:function(t,n,e){"use strict";var r=e(217),i=e(1),a=e(206),s=e(316),o=e(515),l=e(225),c=e(518),u=e(529),f=(e.n(u),e(684));e.n(f);e.d(n,"a",function(){return h});var p=this&&this.__decorate||function(t,n,e,r){var i,a=arguments.length,s=a<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,e,r);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(s=(a<3?i(s):a>3?i(n,e,s):i(n,e))||s);return a>3&&s&&Object.defineProperty(n,e,s),s},d=this&&this.__metadata||function(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},h=function(){function t(){}return t=p([e.i(i.NgModule)({declarations:[o.a,c.a],imports:[r.b,a.FormsModule,s.d,s.e,u.ChartModule,f.Ng2DatetimePickerModule],providers:[l.a],bootstrap:[o.a]}),d("design:paramtypes",[])],t)}()},517:function(t,n,e){"use strict";e.d(n,"a",function(){return r});var r=function(){function t(t,n,e){this.arrivalTime=t,this.leaveTime=n,this.carsCount=e}return t}()},518:function(t,n,e){"use strict";var r=e(1),i=e(225),a=e(683),s=(e.n(a),e(682)),o=(e.n(s),e(517));e.d(n,"a",function(){return u});var l=this&&this.__decorate||function(t,n,e,r){var i,a=arguments.length,s=a<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,e,r);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(s=(a<3?i(s):a>3?i(n,e,s):i(n,e))||s);return a>3&&s&&Object.defineProperty(n,e,s),s},c=this&&this.__metadata||function(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},u=function(){function t(t){var n=this;this.httpService=t,this.logItems=[],this.chartSeries=[],this.filterDateStart="",this.filterDateEnd="",this.showSpinner=!1,this.seriesData=[],this.showMobileInput=!1,this.httpService.logItemsChanged.subscribe(function(t){return n.redrawChart(t)}),this.httpService.jsonError.subscribe(function(t){n.errorMessage=t,n.showSpinner=!1}),this.apiUrl=this.httpService.apiUrl}return t.prototype.getData=function(){this.showSpinner=!0,this.httpService.apiUrl=this.apiUrl,this.httpService.getLogs(),this.filterDateStart="",this.filterDateEnd="",this.errorMessage=""},t.prototype.filterResults=function(){var t=this.seriesData;if(""!=this.filterDateStart){var n=a.utc(this.filterDateStart).unix();t=s.filter(t,function(t){return a.utc(t).unix()>=n})}if(""!=this.filterDateEnd){var e=a.utc(this.filterDateEnd).unix();t=s.filter(t,function(t){return a.utc(t).unix()<=e})}this.processLogs(t)},t.prototype.clearFilers=function(){this.filterDateStart="",this.filterDateEnd="",this.processLogs(this.seriesData)},t.prototype.redrawChart=function(t){this.logItems=t,s.forEach(this.logItems,function(t){t.ArrivalTimeUnix=a.utc(t.ArrivalTime).unix(),t.LeaveTimeUnix=a.utc(t.LeaveTime).unix()}),this.seriesData=s.union(s.map(this.logItems,"ArrivalTime"),s.map(this.logItems,"LeaveTime")),this.seriesData=s.sortBy(this.seriesData,function(t){return a.utc(t).unix()}),this.seriesData=s.uniqBy(this.seriesData,function(t){return a.utc(t).unix()}),this.processLogs(this.seriesData)},t.prototype.processLogs=function(t){this.chartSeries=[];for(var n=[],e=0;e<t.length-1;e++){var r=t[e],i=t[e+1],l=a.utc(r).unix(),c=a.utc(i).unix(),u=s.filter(this.logItems,function(t){return t.ArrivalTimeUnix<=l&&t.LeaveTimeUnix>=c}).length;this.chartSeries.push([1e3*a.utc(r).unix(),u]),n.push(new o.a(r,i,u))}this.maxCarsCount=s.maxBy(n,function(t){return t.carsCount}),void 0!=this.maxCarsCount&&(this.maxCarsCount.arrivalTime=a.utc(this.maxCarsCount.arrivalTime).format("LLL"),this.maxCarsCount.leaveTime=a.utc(this.maxCarsCount.leaveTime).format("LLL")),this.setChartOptions()},t.prototype.setChartOptions=function(){this.options={type:"linear",chart:{zoomType:"x"},xAxis:[{title:{text:"Time"},type:"datetime",ordinal:!1}],yAxis:[{title:{text:"Cars"}}],title:{text:"Parking history"},series:[{name:"history log",data:this.chartSeries}]},this.showSpinner=!1},t=l([e.i(r.Component)({selector:"log-chart",template:e(690),styles:[e(688)]}),c("design:paramtypes",["function"==typeof(n="undefined"!=typeof i.a&&i.a)&&n||Object])],t);var n}()},519:function(t,n,e){"use strict";e.d(n,"a",function(){return r});var r={production:!0}},520:function(t,n,e){"use strict";var r=e(543),i=(e.n(r),e(536)),a=(e.n(i),e(532)),s=(e.n(a),e(538)),o=(e.n(s),e(537)),l=(e.n(o),e(535)),c=(e.n(l),e(534)),u=(e.n(c),e(542)),f=(e.n(u),e(531)),p=(e.n(f),e(530)),d=(e.n(p),e(540)),h=(e.n(d),e(533)),m=(e.n(h),e(541)),v=(e.n(m),e(539)),g=(e.n(v),e(544)),b=(e.n(g),e(963));e.n(b)},687:function(t,n){t.exports=".container{\r\n    margin-top:50px;\r\n}\r\n\r\n"},688:function(t,n){t.exports=".row{\r\n    margin-top:10px;\r\n}\r\n\r\nchart{\r\n    display:block;\r\n}\r\n\r\n.loading{\r\n    width:40px;\r\n    height:40px;\r\n    background:url('../../assets/spin.gif') 0 0 no-repeat;\r\n}\r\n\r\n.bold{\r\n    font-weight:900;\r\n}\r\n\r\n.navbar-toggle{\r\n    margin-left:10px;\r\n}\r\n\r\n.navbar-default{\r\n    position:absolute;\r\n    top:0;\r\n    left:0;\r\n    z-index:10;\r\n    min-width:150px;\r\n}\r\n\r\n.mobile-filters{\r\n    position:absolute;\r\n    top:0;\r\n    right:0;\r\n    margin-top:10px;\r\n}\r\n\r\n.mobile-filters input{\r\n    max-width:80px;\r\n}\r\n\r\n.full-width{\r\n    width:100%;\r\n}\r\n\r\n.mobile-filters input{\r\n    font-size:10px;\r\n}"},689:function(t,n){t.exports='<div class="container" (window:resize)="onResize($event)">\n    <log-chart>Loading...</log-chart>\n</div>\n'},690:function(t,n){t.exports='<div class="form-group has-error">\n    <label class="control-label">{{errorMessage}}</label>\n</div>\n<nav class="navbar navbar-default visible-xs" [ngClass]="{\'full-width\': showMobileInput}">\n    <div class="container-fluid">\n        <!-- Brand and toggle get grouped for better mobile display -->\n        <div class="navbar-header">\n            <button type="button" class="navbar-toggle collapsed pull-left" data-toggle="collapse"\n                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false"\n                    (click)="showMobileInput = false">\n                <span class="sr-only">Toggle navigation</span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n                <span class="icon-bar"></span>\n            </button>\n        </div>\n\n        <!-- Collect the nav links, forms, and other content for toggling -->\n        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n            <ul class="nav navbar-nav">\n                <li><a (click)="getData()">Get Data <span class="sr-only">(current)</span></a></li>\n                <li>\n                    <a (click)="showMobileInput =!showMobileInput">Set API URL</a>\n                    <div [ngClass]="{\'hide\': !showMobileInput}"><input type="text"\n                                                                       class="form-control"\n                                                                       [(ngModel)]="apiUrl"\n                                                                       name="apiUrl" /></div>\n                </li>\n                <li><a (click)="clearFilers()">Clear filters</a></li>\n            </ul>\n        </div><!-- /.navbar-collapse -->\n    </div><!-- /.container-fluid -->\n</nav>\n\n<div class="visible-xs mobile-filters">\n    <div class="pull-left">\n        <input [(ngModel)]="filterDateStart" ng2-datetime-picker\n               date-format="DD-MM-YYYY hh:mm"\n               hour="23"\n               minute=\'59\'\n               close-on-select="false"\n               class="form-control"\n               placeholder="Start"\n               (ngModelChange)="filterResults()" />\n    </div>\n    <div class="pull-right">\n        <input [(ngModel)]="filterDateEnd" ng2-datetime-picker\n               date-format="DD-MM-YYYY hh:mm"\n               hour="23"\n               minute=\'59\'\n               close-on-select="false"\n               class="form-control"\n               placeholder="End"\n               (ngModelChange)="filterResults()" />\n    </div>\n</div>\n\n<div class="row hidden-xs">\n    <div class="col-sm-8">\n        <div class="form-group">\n            <input type="text" class="form-control" [(ngModel)]="apiUrl" name="apiUrl" />\n        </div>\n    </div>\n    <div class="col-sm-2">\n        <div class="form-group">\n            <button class="btn btn-primary form-control" (click)="getData()">Get data</button>\n        </div>\n    </div>\n    <div class="col-sm-1">\n        <div class="loading" [ngClass]="{\'hide\': !showSpinner}"></div>\n    </div>\n</div>\n<div class="row">\n    <div class="col-sm-8">\n        <chart [options]="options"></chart>\n    </div>\n    <div class="col-sm-4 col-xs-12">\n        <h3 class="hidden-xs">Select Date/Time Range</h3>\n        <div class="row hidden-xs">\n            <div class="col-sm-12">\n                <div class="form-group">\n                    <input [(ngModel)]="filterDateStart" ng2-datetime-picker\n                           date-format="DD-MM-YYYY hh:mm"\n                           hour="23"\n                           minute=\'59\'\n                           close-on-select="false"\n                           class="form-control"\n                           placeholder="Start"\n                           (ngModelChange)="filterResults()" />\n                </div>\n            </div>\n            <div class="col-sm-12">\n                <div class="form-group">\n                    <input [(ngModel)]="filterDateEnd" ng2-datetime-picker\n                           date-format="DD-MM-YYYY hh:mm"\n                           hour="23"\n                           minute=\'59\'\n                           close-on-select="false"\n                           class="form-control"\n                           placeholder="End"\n                           (ngModelChange)="filterResults()" />\n                </div>\n            </div>\n            <div class="col-sm-12">\n                <div class="form-group">\n                    <button class="btn btn-secondary" (click)="clearFilers()">Clear filters</button>\n                </div>\n            </div>\n        </div>\n        <span *ngIf="maxCarsCount">\n            <p>Max cars count: {{maxCarsCount.carsCount}} </p>\n            <p>In timeframe between <span class="bold">{{maxCarsCount.arrivalTime}}</span> and <span\n                    class="bold">{{maxCarsCount.leaveTime}}</span></p>\n        </span>\n    </div>\n</div>\n\n'},964:function(t,n){function e(t){throw new Error("Cannot find module '"+t+"'.")}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id=964},965:function(t,n,e){t.exports=e(409)}},[965]);
//# sourceMappingURL=main.a73cf21f89e8d33880bc.bundle.map